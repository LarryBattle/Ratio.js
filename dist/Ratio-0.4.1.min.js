/*Ratio.js version:0.4.1 by Larry Battle*/
var Ratio=function(){"use strict";var t=function(e,n,i){if(!(this instanceof t))return new t(e,n,i);this.divSign="/",this.alwaysReduce=!!i;var r=t.getStandardRatioArray(e,n,this.alwaysReduce);return this._n=r[0],this._d=r[1],this};return t.MAX_PRECISION=(1/3).toString().length-2,t.MAX_VALUE=Math.pow(2,53),t.MIN_VALUE=-Math.pow(2,53),t.regex={divSignCheck:/(\d|Infinity)\s*\//,divSignSplit:/\//,cleanFormat:/^\d+\.\d+$/,mixedNumbers:/(\S+)\s+(\S[\w\W]*)/,repeatingDecimals:/[^\.]+\.\d*(\d{2,})+(?:\1)$/,repeatingNumbers:/^(\d+)(?:\1)$/},t.VERSION="0.4.1",t.isNumeric=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},t.getValueIfDefined=function(t,e){return"undefined"!=typeof e&&null!==e?e:t},t.gcd=function(t,e){if(arguments.length<2)return t;var n;if(t=+t,e=+e,t!==t||e!==e)return 0/0;if(1/0===t||t===-1/0||1/0===e||e===-1/0)return 1/0;if(t%1!==0||e%1!==0)throw new Error("Can only operate on integers");for(;e;)n=t%e,t=e,e=n;return t>0?t:-t},t.getNumeratorWithSign=function(t,e){var n=0>+t*(+e||1)?-1:1;return Math.abs(+t)*n},t.guessType=function(e){var n="NaN";return e instanceof t?n="Ratio":isNaN(e)?t.regex.divSignCheck.test(e)&&(n=/\d\s+[+\-]?\d/.test(e)?"mixed":"fraction"):(n="number",-1<(+e).toString().indexOf("e")?n="e":e%1&&(n="decimal")),n},t.parseToArray=function(e){var n,i,r,a=[],s=[];switch(t.guessType(e)){case"mixed":a=e.match(t.regex.mixedNumbers),s=t.parseToArray(a[2]),n=+a[1]<0||+s[0]<0?-1:1,s[0]=n*(Math.abs(s[0])+Math.abs(a[1]*s[1]));break;case"fraction":a=e.split(t.regex.divSignSplit),s[0]=t.getNumeratorWithSign(a[0],a[1]),s[1]=Math.abs(+a[1]);break;case"decimal":a=(+e).toString().split("."),s[1]=Math.pow(10,a[1].length),s[0]=Math.abs(a[0])*s[1]+ +a[1],s[0]=-1<a[0].indexOf("-")?-s[0]:s[0];break;case"number":s=[+e,1];break;case"e":a=(+e).toString().split(/e/i),r=t.parseToArray(a[0]),i=Math.abs(+e)<1?[0,1]:[1,0],s[i[0]]=r[i[0]],s[i[1]]=Number(r[i[1]]+"e"+Math.abs(+a[1]));break;case"Ratio":s=[e._n,e._d];break;default:s=[0/0,1]}return s},t.parse=function(e,n){var i,r=t.parseToArray(e);return r.length&&void 0!==n&&null!==n&&(i=t.parseToArray(n),r[0]*=i[1],r[1]*=i[0]),new t(r[0],r[1])},t.simplify=function(e,n){e=t.parse(e,n);var i,r=e._n,a=r||!e._d?e._d:1,s=t.getRepeatProps(r/a);return s.length&&(r=Number(s.join(""))-Number(s[0]+String(s[1])),a=Math.pow(10,s[1].length)*(Math.pow(10,s[2].length)-1)),i=t.gcd(r,a),[r/i,a/i]},t.getRepeatProps=function(e){e=String(e||"");var n,i=[],r=t.regex.repeatingDecimals.exec(e),a=t.regex.repeatingNumbers;return r||(e=e.replace(/\d$/,""),r=t.regex.repeatingDecimals.exec(e)),r&&1<r.length&&/\.\d{10}/.test(r[0])&&(r[1]=a.test(r[1])?a.exec(r[1])[1]:r[1],n=new RegExp("("+r[1]+")+$"),i=e.split(/\./).concat(r[1]),i[1]=i[1].replace(n,"")),i},t.getPrimeFactors=function(t){t=Math.floor(t);for(var e,n,i=[],r=Math.sqrt,a=t>1&&isFinite(t);a;){if(e=r(t),n=2,t%n)for(n=3;t%n&&(n+=2)<e;);n=n>e?t:n,i.push(n),a=n!==t,t/=n}return i},t.getCleanENotation=function(t){if(t=(+t||0).toString(),/\.\d+(0|9){8,}\d?e/.test(t)){var e=t.match(/(?:\d+\.)(\d+)(?:e[\w\W]*)/)[1].replace(/(0|9)+\d$/,"").length+1;t=(+t).toPrecision(e).toString()}return t},t.simplifyENotation=function(t,e){var n=t/e,i=/[eE]/;if(!isNaN(n)&&i.test(t)&&i.test(e)){var r=t.toString().split("e"),a=e.toString().split("e");Number(a[1])<Number(r[1])?(r[1]=Number(r[1])+-1*a[1],a[1]=0):(a[1]=Number(a[1])+-1*r[1],r[1]=0),t=Number(r.join("e")),e=Number(a.join("e"))}return[t,e]},t.getCombinedRatio=function(e,n){return e instanceof t&&void 0===n||(e=t.parse(e,n)),e},t.random=function(){var e=Math.random().toFixed(Math.floor(16*Math.random()));return t.parse(e).simplify()},t.getStandardRatioArray=function(e,n,i){"undefined"==typeof n&&(n=1,"undefined"==typeof e&&(e=0));var r=+Math.abs(n),a=t.getNumeratorWithSign(e,n||1),s=[a,r];return s[1]&&i&&(s=t.simplify(s[0],s[1])),s},t.prototype={constructor:t,numerator:function(e){return"undefined"!=typeof e&&(this._n=t.parse(e).valueOf()),this._n},denominator:function(e){return"undefined"!=typeof e&&(this._d=t.parse(e).valueOf(),this.correctRatio()),this._d},correctRatio:function(){var e=t.getStandardRatioArray(this._n,this._d,this.alwaysReduce);return this._n=e[0],this._d=e[1],this},toArray:function(){return[this._n,this._d]},valueOf:function(){var e=t.simplifyENotation(this._n,this._d);return e[0]/e[1]},toLocaleString:function(){var t,e,n=this.valueOf();return isNaN(n)?e="NaN":n%1!==0&&1!==this._d&&isFinite(n%1)?1<Math.abs(n)?(t=parseInt(n,10),e=t+" "+Math.abs(this._n%this._d)+String(this.divSign)+this._d):e=this._n+String(this.divSign)+this._d:e=String(n),e},toString:function(){return String(this._n+this.divSign+this._d)},clone:function(e,n,i){var r=t.getValueIfDefined;return e=r(this._n,e),n=r(this._d,n),i=r(this.alwaysReduce,i),new t(e,n,i)},isNaN:function(){return!t.isNumeric(this.valueOf())},simplify:function(){var e=t.simplify(this._n,this._d);return this.clone(e[0],e[1])},add:function(e,n){e=t.getCombinedRatio(e,n);var i,r,a;return this._d===e._d?(r=this._n+e._n,a=this._d):(i=t.gcd(this._d,e._d),r=(this._n*e._d+this._d*e._n)/i,a=this._d*e._d/i),this.clone(r,a)},divide:function(e,n){return e=t.getCombinedRatio(e,n),this.clone(this._n*e._d,this._d*e._n)},equals:function(e){var n=t.isNumeric(e)||e instanceof t?e.valueOf():t.parse(e).valueOf();return this._n/this._d===+n},deepEquals:function(e){return e instanceof t&&this._n===e._n&&this._d===e._d&&this.divSign===e.divSign&&this.alwaysReduce===e.alwaysReduce},multiply:function(e,n){return e=t.getCombinedRatio(e,n),this.clone(this._n*e._n,this._d*e._d)},subtract:function(e,n){e=t.getCombinedRatio(e,n);var i,r,a;return this._d===e._d?(r=this._n-e._n,a=this._d):(i=t.gcd(this._d,e._d),r=(this._n*e._d-this._d*e._n)/i,a=this._d*e._d/i),this.clone(r,a)},descale:function(e,n){var i=t.getCombinedRatio(e,n);return this.clone(this._n/i,this._d/i)},pow:function(e,n){var i=t.getCombinedRatio(e,n);return this.clone(Math.pow(this._n,+i),Math.pow(this._d,+i))},scale:function(e,n){var i=t.getCombinedRatio(e,n);return this.clone(this._n*+i,this._d*+i)},cleanFormat:function(){var e,n=t.regex.cleanFormat;return n.test(this._n)||n.test(this._d)?t.parse(this._n,this._d):(e=this.clone(),e._n=t.getCleanENotation(e._n),e._d=t.getCleanENotation(e._d),e)},abs:function(){return this.clone(Math.abs(this._n))},mod:function(){return this.clone(this._n%this._d,1)},negate:function(){return this.clone(-this._n)},isProper:function(){return Math.abs(this._n)<this._d},findX:function(e){var n=String(e).split("/");return 2!==n.length||!isNaN(n[0])&&!isNaN(n[1])?null:isNaN(n[0])?new t(n[1]).multiply(this):new t(n[0]).divide(this)},reciprocal:function(){return this.clone(this._d,this._n)},toQuantityOf:function(){var t,e,n,i=this.valueOf(),r=1/0,a=arguments.length;for(n=0;a>n;n+=1)e=Math.abs(Math.round(i*arguments[n])/arguments[n]-i),r>e&&(t=arguments[n],r=e);return this.clone(Math.round(i*t),t)},floor:function(){return this.clone(Math.floor(this.valueOf()),1)},ceil:function(){return this.clone(Math.ceil(this.valueOf()),1)},makeProper:function(){return this.clone(this._n%this._d,this._d)}},t}();"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=Ratio),exports.Ratio=Ratio):this.Ratio=Ratio;