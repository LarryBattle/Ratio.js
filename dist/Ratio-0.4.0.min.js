/**
 * @project Ratio.js
 * @purpose Provides a Ratio(Fraction) object for Javascript. Similar to Fraction.py for Python.
 * @author Larry Battle , <http://bateru.com/news/>
 * @license MIT and GPL 3.0
MIT License <http://www.opensource.org/licenses/mit-license>
GPL v3 <http://opensource.org/licenses/GPL-3.0>
 * @info Project page: <https://github.com/LarryBattle/Ratio.js/>
 * @version 0.4.0
 * @note Uses YUI-DOC to generate documentation.
 **/var Ratio=function(){"use strict";var e=function(t,n,r){if(this instanceof e){this.divSign="/",this.alwaysReduce=!!r;var i=e.getStandardRatioArray(t,n,this.alwaysReduce);return this._n=i[0],this._d=i[1],this}return new e(t,n,r)};return e.MAX_PRECISION=(1/3).toString().length-2,e.MAX_VALUE=Math.pow(2,53),e.MIN_VALUE=-Math.pow(2,53),e.regex={divSignCheck:/(\d|Infinity)\s*\//,divSignSplit:/\//,cleanFormat:/^\d+\.\d+$/,mixedNumbers:/(\S+)\s+(\S[\w\W]*)/,repeatingDecimals:/[^\.]+\.\d*(\d{2,})+(?:\1)$/,repeatingNumbers:/^(\d+)(?:\1)$/},e.VERSION="0.4.0",e.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},e.getValueIfDefined=function(e,t){return typeof t!="undefined"&&t!==null?t:e},e.gcd=function(e,t){var n;t=+t&&+e?+t:0,e=t?e:1;while(t)n=e%t,e=t,t=n;return Math.abs(e)},e.getNumeratorWithSign=function(e,t){var n=+e*(+t||1)<0?-1:1;return Math.abs(+e)*n},e.guessType=function(t){var n="NaN";return t instanceof e?n="Ratio":isNaN(t)?e.regex.divSignCheck.test(t)&&(/\d\s+[+\-]?\d/.test(t)?n="mixed":n="fraction"):(n="number",-1<(+t).toString().indexOf("e")?n="e":t%1&&(n="decimal")),n},e.parseToArray=function(t){var n=[],r,i,s=[],o;switch(e.guessType(t)){case"mixed":n=t.match(e.regex.mixedNumbers),s=e.parseToArray(n[2]),r=+n[1]<0||+s[0]<0?-1:1,s[0]=r*(Math.abs(s[0])+Math.abs(n[1]*s[1]));break;case"fraction":n=t.split(e.regex.divSignSplit),s[0]=e.getNumeratorWithSign(n[0],n[1]),s[1]=Math.abs(+n[1]);break;case"decimal":n=(+t).toString().split("."),s[1]=Math.pow(10,n[1].length),s[0]=Math.abs(n[0])*s[1]+ +n[1],s[0]=-1<n[0].indexOf("-")?-s[0]:s[0];break;case"number":s=[+t,1];break;case"e":n=(+t).toString().split(/e/i),o=e.parseToArray(n[0]),i=Math.abs(+t)<1?[0,1]:[1,0],s[i[0]]=o[i[0]],s[i[1]]=Number(o[i[1]]+"e"+Math.abs(+n[1]));break;case"Ratio":s=[t._n,t._d];break;default:s=[NaN,1]}return s},e.parse=function(t,n){var r=e.parseToArray(t),i;return r.length&&n!==undefined&&n!==null&&(i=e.parseToArray(n),r[0]*=i[1],r[1]*=i[0]),new e(r[0],r[1])},e.simplify=function(t,n){t=e.parse(t,n);var r=t._n,i=r||!t._d?t._d:1,s=e.getRepeatProps(r/i),o;return s.length&&(r=Number(s.join(""))-Number(s[0]+String(s[1])),i=Math.pow(10,s[1].length)*(Math.pow(10,s[2].length)-1)),o=e.gcd(r,i),[r/o,i/o]},e.getRepeatProps=function(t){t=String(t||"");var n=[],r=e.regex.repeatingDecimals.exec(t),i,s=e.regex.repeatingNumbers;return r||(t=t.replace(/\d$/,""),r=e.regex.repeatingDecimals.exec(t)),r&&1<r.length&&/\.\d{10}/.test(r[0])&&(r[1]=s.test(r[1])?s.exec(r[1])[1]:r[1],i=new RegExp("("+r[1]+")+$"),n=t.split(/\./).concat(r[1]),n[1]=n[1].replace(i,"")),n},e.getPrimeFactors=function(e){e=Math.floor(e);var t,n=[],r,i=Math.sqrt,s=1<e&&isFinite(e);while(s){t=i(e),r=2;if(e%r){r=3;while(e%r&&(r+=2)<t);}r=t<r?e:r,n.push(r),s=r!==e,e/=r}return n},e.getCleanENotation=function(e){e=(+e||0).toString();if(/\.\d+(0|9){8,}\d?e/.test(e)){var t=e.match(/(?:\d+\.)(\d+)(?:e[\w\W]*)/)[1].replace(/(0|9)+\d$/,"").length+1;e=(+e).toPrecision(t).toString()}return e},e.simplifyENotation=function(e,t){var n=e/t,r=/[eE]/;if(!isNaN(n)&&r.test(e)&&r.test(t)){var i=e.toString().split("e"),s=t.toString().split("e");Number(s[1])<Number(i[1])?(i[1]=Number(i[1])+ -1*s[1],s[1]=0):(s[1]=Number(s[1])+ -1*i[1],i[1]=0),e=Number(i.join("e")),t=Number(s.join("e"))}return[e,t]},e.getCombinedRatio=function(t,n){if(!(t instanceof e)||n!==undefined)t=e.parse(t,n);return t},e.random=function(){var t=Math.random().toFixed(Math.floor(Math.random()*16));return e.parse(t).simplify()},e.getStandardRatioArray=function(t,n,r){typeof n=="undefined"&&(n=1,typeof t=="undefined"&&(t=0));var i=+Math.abs(n),s=e.getNumeratorWithSign(t,n||1),o=[s,i];return o[1]&&r&&(o=e.simplify(o[0],o[1])),o},e.prototype={constructor:e,numerator:function(t){return typeof t!="undefined"&&(this._n=e.parse(t).valueOf()),this._n},denominator:function(t){return typeof t!="undefined"&&(this._d=e.parse(t).valueOf(),this.correctRatio()),this._d},correctRatio:function(){var t=e.getStandardRatioArray(this._n,this._d,this.alwaysReduce);return this._n=t[0],this._d=t[1],this},toArray:function(){return[this._n,this._d]},valueOf:function(){var t=e.simplifyENotation(this._n,this._d);return t[0]/t[1]},toLocaleString:function(){var e=this.valueOf(),t,n;return isNaN(e)?n="NaN":e%1===0||this._d===1||!isFinite(e%1)?n=String(e):1<Math.abs(e)?(t=parseInt(e,10),n=t+" "+Math.abs(this._n%this._d)+String(this.divSign)+this._d):n=this._n+String(this.divSign)+this._d,n},toString:function(){return String(this._n+this.divSign+this._d)},clone:function(t,n,r){var i=e.getValueIfDefined;return t=i(this._n,t),n=i(this._d,n),r=i(this.alwaysReduce,r),new e(t,n,r)},isNaN:function(){return!e.isNumeric(this.valueOf())},simplify:function(){var t=e.simplify(this._n,this._d);return this.clone(t[0],t[1])},add:function(t,n){t=e.getCombinedRatio(t,n);var r,i,s;return this._d===t._d?(i=this._n+t._n,s=this._d):(r=e.gcd(this._d,t._d),i=(this._n*t._d+this._d*t._n)/r,s=this._d*t._d/r),this.clone(i,s)},divide:function(t,n){return t=e.getCombinedRatio(t,n),this.clone(this._n*t._d,this._d*t._n)},equals:function(t){var n=e.isNumeric(t)||t instanceof e?t.valueOf():e.parse(t).valueOf();return this._n/this._d===+n},deepEquals:function(t){return t instanceof e&&this._n===t._n&&this._d===t._d&&this.divSign===t.divSign&&this.alwaysReduce===t.alwaysReduce},multiply:function(t,n){return t=e.getCombinedRatio(t,n),this.clone(this._n*t._n,this._d*t._d)},subtract:function(t,n){t=e.getCombinedRatio(t,n);var r,i,s;return this._d===t._d?(i=this._n-t._n,s=this._d):(r=e.gcd(this._d,t._d),i=(this._n*t._d-this._d*t._n)/r,s=this._d*t._d/r),this.clone(i,s)},descale:function(t,n){var r=e.getCombinedRatio(t,n);return this.clone(this._n/r,this._d/r)},pow:function(t,n){var r=e.getCombinedRatio(t,n);return this.clone(Math.pow(this._n,+r),Math.pow(this._d,+r))},scale:function(t,n){var r=e.getCombinedRatio(t,n);return this.clone(this._n*+r,this._d*+r)},cleanFormat:function(){var t=e.regex.cleanFormat,n;return t.test(this._n)||t.test(this._d)?e.parse(this._n,this._d):(n=this.clone(),n._n=e.getCleanENotation(n._n),n._d=e.getCleanENotation(n._d),n)},abs:function(){return this.clone(Math.abs(this._n))},mod:function(){return this.clone(this._n%this._d,1)},negate:function(){return this.clone(-this._n)},isProper:function(){return Math.abs(this._n)<this._d},findX:function(t){var n=String(t).split("/");return n.length!==2||!isNaN(n[0])&&!isNaN(n[1])?null:isNaN(n[0])?(new e(n[1])).multiply(this):(new e(n[0])).divide(this)},reciprocal:function(){return this.clone(this._d,this._n)},toQuantityOf:function(){var e=this.valueOf(),t,n,r,i=Infinity,s=arguments.length;for(r=0;r<s;r+=1)n=Math.abs(Math.round(e*arguments[r])/arguments[r]-e),n<i&&(t=arguments[r],i=n);return this.clone(Math.round(e*t),t)},floor:function(){return this.clone(Math.floor(this.valueOf()),1)},ceil:function(){return this.clone(Math.ceil(this.valueOf()),1)},makeProper:function(){return this.clone(this._n%this._d,this._d)}},e}();typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=Ratio),exports.Ratio=Ratio):this.Ratio=Ratio;