/**
 * @project Ratio.js
 * @purpose Provides a Ratio(Fraction) object for Javascript. Similar to Fraction.py for Python.
 * @author Larry Battle , <http://bateru.com/news/>
 * @license MIT and GPL 3.0
MIT License <http://www.opensource.org/licenses/mit-license>
GPL v3 <http://opensource.org/licenses/GPL-3.0>
 * @info Project page: <https://github.com/LarryBattle/Ratio.js/>
 * @version 0.3.4
 * @note Uses YUI-DOC to generate documentation.
 **//**
 * Ratio is an object that has a numerator and denominator, corresponding to a/b.<br/>
 * Note that the keyword `new` is not required to create a new instance of the Ratio object, since this is done for you.<br/>
 * In otherwords, `new Ratio( value )` is the same as `Ratio( value )`.
 *
 * @class Ratio
 * @constructor
 * @chainable
 * @param {Ratio|String|Number} [numerator=0] can be a Ratio object or numeric value.
 * @param {Ratio|String|Number} [denominator=1] can be a Ratio object or numeric value.
 * @param {Boolean} [alwaysReduce] if true, then the Ratio object and the child of it will always represent the simplified form of the rational.
 * @return {Ratio} object that has a numerator and denominator, corresponding to a/b.
 * @example
Ratio(2,4).toString() == Ratio("2/4").toString() == "2/4"
 **/var Ratio=function(e,t,n){return this instanceof Ratio?(this.divSign="/",this.alwaysReduce=!!n,this.denominator=t,this.numerator=e,this.correctRatio()):new Ratio(e,t,n)};Ratio.VERSION="0.3.4",Ratio.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},Ratio.getValueIfDefined=function(e,t){return typeof t!="undefined"&&t!==null?t:e},Ratio.gcd=function(e,t){var n;t=+t&&+e?+t:0,e=t?e:1;while(t)n=e%t,e=t,t=n;return Math.abs(e)},Ratio.getNumeratorWithSign=function(e,t){var n=+e*(+t||1)<0?-1:1;return Math.abs(+e)*n},Ratio.getTypeGuess=function(e){var t="NaN";return e instanceof Ratio?t="Ratio":isNaN(e)?/\d\s*[^\s\d\w]/.test(e)&&(/\d\s+[+\-]?\d/.test(e)?t="mixed":t="fraction"):(t="number",/e/i.test(+e)?t="e":e%1&&(t="decimal")),t},Ratio.parseToArray=function(e){var t=[],n,r=[],i;switch(Ratio.getTypeGuess(e)){case"mixed":t=e.match(/(\S+)\s+(\S.*)/),r=Ratio.parseToArray(t[2]),n=0<parseFloat(t[1])*r[0]?1:-1,r[0]=n*(Math.abs(r[0])+Math.abs(t[1]*r[1]));break;case"fraction":t=e.split(/[^\s\d\w]/),r[0]=Ratio.getNumeratorWithSign(t[0],t[1]),r[1]=Math.abs(+t[1]);break;case"decimal":t=(+e).toString().split(/\./),r[1]=Math.pow(10,t[1].length),r[0]=Math.abs(t[0])*r[1]+ +t[1],r[0]=/\-/.test(t[0])?-r[0]:r[0];break;case"number":r=[+e,1];break;case"e":t=(+e).toString().split(/e/i),i=Ratio.parseToArray(t[0]),n=Math.abs(+e)<1?[0,1]:[1,0],r[n[0]]=i[n[0]],r[n[1]]=+(i[n[1]]+"e"+Math.abs(+t[1]));break;case"Ratio":r=[e.numerator,e.denominator];break;default:r=[NaN,1]}return r},Ratio.parse=function(e,t){var n=Ratio.parseToArray(e),r;return n.length&&typeof t!="undefined"&&t!==null&&(r=Ratio.parseToArray(t),n[0]*=r[1],n[1]*=r[0]),new Ratio(n[0],n[1])},Ratio.reduce=function(e,t){e=Ratio.parse(e,t);var n=e.numerator,r=e.denominator,i=Ratio.getRepeatProps(n/r);i.length&&(n=+i.join("")- +(i[0]+""+i[1]),r=Math.pow(10,i[1].length)*(Math.pow(10,i[2].length)-1));var s=Ratio.gcd(n,r);return[n/s,r/s]},Ratio.getRepeatProps=function(e){e=""+(e||"");var t=/(?:[^\.]+\.\d*)(\d{2,})+(?:\1)$/,n=[],r=t.exec(e),i,s=/^(\d+)(?:\1)$/;return r||(e=e.replace(/\d$/,""),r=t.exec(e)),r&&1<r.length&&/\.\d{10}/.test(r[0])&&(r[1]=s.test(r[1])?s.exec(r[1])[1]:r[1],i=new RegExp("("+r[1]+")+$"),n=e.split(/\./).concat(r[1]),n[1]=n[1].replace(i,"")),n},Ratio.getPrimeFactors=function(e){e=Math.floor(e);var t,n=[],r,i=Math.sqrt,s=1<e&&isFinite(e);while(s){t=i(e),r=2;if(e%r){r=3;while(e%r&&(r+=2)<t);}r=t<r?e:r,n.push(r),s=r!=e,e/=r}return n},Ratio.getCleanENotation=function(e){e=(+e||0).toString();if(/\.\d+(0|9){8,}\d?e/.test(e)){var t=e.match(/(?:\d+\.)(\d+)(?:e.*)/)[1].replace(/(0|9)+\d$/,"").length+1;e=(+e).toPrecision(t).toString()}return e},Ratio.prototype={constructor:Ratio,correctRatio:function(){var e=this.numerator;b=this.denominator,typeof b=="undefined"&&(b=1,typeof e=="undefined"&&(e=0)),this.denominator=+Math.abs(b),this.numerator=Ratio.getNumeratorWithSign(e,b||1);if(this.denominator&&this.alwaysReduce){var t=Ratio.reduce(this);this.numerator=t[0],this.denominator=t[1]}return this},toArray:function(){return[this.numerator,this.denominator]},valueOf:function(){return this.numerator/this.denominator},toLocaleString:function(){var e=this.valueOf(!0),t,n,r=1e-9;return isNaN(e)?n="NaN":e%1===0||this.denominator===1||!isFinite(e%1)?n=""+e:1<Math.abs(e)?Math.abs(e-e.toFixed(0))<r?n=e.toFixed(0):(t=parseInt(e,10),n=t+" "+Math.abs(this.numerator%this.denominator)+this.divSign+this.denominator):n=""+this.numerator+this.divSign+this.denominator,n},toString:function(){return""+this.numerator+this.divSign+this.denominator},clone:function(e,t,n){var r=Ratio.getValueIfDefined;return e=r(this.numerator,e),t=r(this.denominator,t),n=r(this.alwaysReduce,n),new Ratio(e,t,n)},reduce:function(){var e=Ratio.reduce(this.numerator,this.denominator);return this.clone(e[0],e[1])},add:function(e,t){if(!(e instanceof Ratio)||typeof t!="undefined")e=Ratio.parse(e,t);var n,r,i;return this.denominator==e.denominator?(r=this.numerator+e.numerator,i=this.denominator):(n=Ratio.gcd(this.denominator,e.denominator),r=(this.numerator*e.denominator+this.denominator*e.numerator)/n,i=this.denominator*e.denominator/n),this.clone(r,i)},divide:function(e,t){if(!(e instanceof Ratio)||typeof t!="undefined")e=Ratio.parse(e,t);return this.clone(this.numerator*e.denominator,this.denominator*e.numerator)},equals:function(e){var t=Ratio.isNumeric(e)||e instanceof Ratio?e.valueOf(!0):Ratio.parse(e).valueOf(!0);return this.numerator/this.denominator==+t},deepEquals:function(e){return e instanceof Ratio&&this.numerator===e.numerator&&this.denominator===e.denominator},multiply:function(e,t){if(!(e instanceof Ratio)||typeof t!="undefined")e=Ratio.parse(e,t);return this.clone(this.numerator*e.numerator,this.denominator*e.denominator)},subtract:function(e,t){if(!(e instanceof Ratio)||typeof t!="undefined")e=Ratio.parse(e,t);return e.numerator=-e.numerator,this.add(e)},descale:function(e){return this.clone(this.numerator/e,this.denominator/e)},pow:function(e){return this.clone(Math.pow(this.numerator,+e),Math.pow(this.denominator,+e))},scale:function(e){return this.clone(this.numerator*+e,this.denominator*+e)},cleanFormat:function(){var e=/^\d+\.\d+$/;if(e.test(this.numerator)||e.test(this.denominator))return Ratio.parse(this.numerator,this.denominator);var t=this.clone();return t.numerator=Ratio.getCleanENotation(t.numerator),t.denominator=Ratio.getCleanENotation(t.denominator),t},abs:function(){return this.clone(Math.abs(this.numerator))},mod:function(){return this.clone(this.numerator%this.denominator,1)},negate:function(){return this.clone(-this.numerator)},isProper:function(){return Math.abs(this.numerator)<this.denominator},findX:function(e){var t=(""+e).split("/");return t.length!==2?null:isNaN(t[0])?Ratio(t[1]).multiply(this):Ratio(t[0]).divide(this)},reciprocal:function(){return this.clone(this.denominator,this.numerator)},approximateTo:function(e){return isNaN(e)?this.clone():this.clone(Math.round(this.valueOf(!0)*e),e)},toQuantityOf:function(){var e=Array.prototype.slice.call(arguments);if(e.length<1)return this.clone(NaN,1);var t=this.valueOf(!0),n=this.approximateTo(e[0]),r,i=1e-9;for(var s=1,o=e.length;s<o&&i<Math.abs(n-t);s++)r=n,n=this.approximateTo(e[s]),Math.abs(r-t)<Math.abs(n-t)&&(n=r);return n}},typeof exports!="undefined"&&(typeof module!="undefined"&&module.exports&&(exports=module.exports=Ratio),exports.Ratio=Ratio);